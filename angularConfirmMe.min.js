angular.module("angularConfirmMe",[]).factory("ConfirmMe",["$rootScope","$timeout",function(n,e){function o(n,e){for(var t in e)try{n[t]=e[t].constructor==Object?o(n[t],e[t]):e[t]}catch(r){n[t]=e[t]}return n}function t(n,e,o){null==e&&(e=function(){return!0});var t=[],r=n.length,i=0;for(i;r>i;i++){var c=n[i],f=e(c,i);f&&(t.push(c),"function"==typeof o&&o(c,i))}return t}function r(n){var e={},t={message:"Are you sure you want to do this?",onConfirm:function(){},onCancel:function(){},onClose:function(){}};if("undefined"!=typeof n.message){var r=t.message;try{r=n.message.trim()}catch(i){throw new ReferenceError("ConfirmMe invalid type for feild: Message which should be String")}finally{if(""==r)throw new ReferenceError("Notifyme empty required feild: Message(String)")}}return e.id=Math.floor(999999999*Math.random()),e=o(t,o(e,n))}function i(n){var e=t(u,function(e){return e.id===parseInt(n)});return e.length>0?e[0]:[]}function c(n){return angular.element(document.querySelector("#confirme-"+n))}function f(o){a===!0&&(a=!1,t(u,function(n){return n.id===parseInt(o)},function(t,r){c(o).removeClass("is-visible"),e(function(){u.splice(r,1),n.$broadcast("confirmations:updated"),a=!0,t.onClose()},300)}))}var u=[],a=!0;return{getConfirmations:function(){return u},confirm:function(o){o="undefined"==typeof o?{}:o;var t=r(o);u.push(t),n.$broadcast("confirmations:updated"),e(function(){c(t.id).addClass("is-visible")},50)},cancel:function(n){console.log("Canceled",n,c(n)),i(n).onCancel(),f(n)},confirmed:function(n){i(n).onConfirm(),f(n)},close:function(){f.apply(this,arguments)}}}]).controller("ConfirmMeController",["$scope","ConfirmMe",function(n,e){n.confirmations=e.getConfirmations(),n.close=e.close,n.confirm=e.confirmed,n.cancel=e.cancel,n.$on("confirmations:updated",function(){n.confirmations=e.getConfirmations()})}]).directive("confirmme",["ConfirmMe",function(n){return{restrict:"AE",replace:!0,templateUrl:"template.html",link:function(){angular.element(document).on("keydown",function(){var e=document.querySelectorAll(".confirme-popup.is-visible");if(e.length>0){var o=e[e.length-1].getAttribute("id").split("-")[1];n.close(o)}})}}}]);